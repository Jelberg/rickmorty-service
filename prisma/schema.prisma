// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model TYPES {
  type_id    Int      @id @default(autoincrement())
  type_name  String   // ['EPISODES', 'CHARACTERS']
  TYPE_STAT  TYPE_STAT[]
}

model STATUS {
  stat_id   Int      @id @default(autoincrement())
  stat_name String   // ['ACTIVE', 'SUSPENDED', 'CANCELLED', 'ACTIVE']
  TYPE_STAT TYPE_STAT[]
}

model TYPE_STAT {
  ts_id        Int      @id @default(autoincrement())
  ts_fk_type   Int
  ts_fk_state  Int

  TYPES    TYPES    @relation(fields: [ts_fk_type], references: [type_id])
  STATUS   STATUS   @relation(fields: [ts_fk_state], references: [stat_id])
  CHARACTERS  CHARACTERS[]
  EPISODES    EPISODES[]
}

model CHARACTERS {
  char_id        Int      @id @default(autoincrement())
  char_fk_typestat Int
  char_name      String

  TYPE_STAT   TYPE_STAT   @relation(fields: [char_fk_typestat], references: [ts_id])
  SUBC_CHAR_EPIS SUBC_CHAR_EPIS[]
  EPIS_CHAR      EPIS_CHAR[]
}

model EPISODES {
  epis_id         Int      @id @default(autoincrement())
  epis_fk_typestat Int
  epis_duration   Int      // Duración en minutos (Máximo 60 MIN)

  TYPE_STAT   TYPE_STAT   @relation(fields: [epis_fk_typestat], references: [ts_id])
  SUBC_CHAR_EPIS SUBC_CHAR_EPIS[]
  EPIS_CHAR      EPIS_CHAR[]
}

model CATEGORIES {
  cate_id        Int       @id @default(autoincrement())
  cate_name      String
  SUBCATEGORIES  SUBCATEGORIES[]
}

model SUBCATEGORIES {
  subc_id        Int       @id @default(autoincrement())
  subc_name      String
  subc_fk_cate   Int       // Campo escalar para la clave foránea

  CATEGORIES     CATEGORIES     @relation(fields: [subc_fk_cate], references: [cate_id])
  SUBC_CHAR_EPIS SUBC_CHAR_EPIS[]
}

model EPIS_CHAR {
  ec_id         Int      @id @default(autoincrement())
  ec_fk_char    Int      // Campo escalar para la clave foránea
  ec_fk_epis    Int      // Campo escalar para la clave foránea
  ec_fk_time    Int      // Campo escalar para la clave foránea
  ec_duration   Int      // Duración en minutos

  CHARACTERS    CHARACTERS  @relation(fields: [ec_fk_char], references: [char_id])
  EPISODES      EPISODES    @relation(fields: [ec_fk_epis], references: [epis_id])
  TIMES         TIMES       @relation(fields: [ec_fk_time], references: [time_id])
}

model SUBC_CHAR_EPIS {
  sce_id         Int      @id @default(autoincrement())
  sce_fk_char    Int      // Campo escalar para la clave foránea
  sce_fk_subc    Int      // Campo escalar para la clave foránea
  sce_fk_epis    Int      // Campo escalar para la clave foránea

  CHARACTERS     CHARACTERS     @relation(fields: [sce_fk_char], references: [char_id])
  SUBCATEGORIES  SUBCATEGORIES  @relation(fields: [sce_fk_subc], references: [subc_id])
  EPISODES       EPISODES       @relation(fields: [sce_fk_epis], references: [epis_id])

  @@unique([sce_fk_char, sce_fk_subc, sce_fk_epis]) // Garantiza la unicidad de esta combinación
}

model TIMES {
  time_id      Int      @id @default(autoincrement())
  time_init    DateTime
  time_finish  DateTime

  EPIS_CHAR    EPIS_CHAR[]
}
